prepared WebSocket plus working REST API with authentication and authorization